# FGFR1-ITD-seeker

FGFR1-ITD-seeker is a specialized bioinformatics tool designed to detect internal tandem duplications (ITDs) in the FGFR1 gene from short-read next-generation sequencing data. FGFR1 ITDs are rare but recurrent oncogenic alterations found primarily in pediatric low-grade gliomas and in a small subset of soft tissue tumors, where duplicated segments within the kinase domain lead to constitutive receptor activation and uncontrolled cell proliferation. This tool leverages VarDict variant caller under the hood to identify these tandem duplications. By automating the detection process, FGFR1-ITD-seeker enables rapid and reliable identification of this rare but clinically significant variant in a routine DNAseq bioinformatics pipeline.

## Features

- Automated detection of FGFR1 internal tandem duplications
- Breakpoint validation at the exon 18 region
- Configurable minimum variant allele frequency (VAF) threshold
- Support for multiple human genome versions (hg19, hg38)
- Multi-threaded processing for improved performance

## Installation

### Prerequisites
Operating System
- Linux
- MacOS
- WSL environment in Windows (not tested)

Compiler dependency
- Go 1.21 or higher (for installation only). Not needed if you use the pre-build binary

Software dependencies (for execution of the program)
- [VarDict](https://github.com/AstraZeneca-NGS/VarDictJava) variant caller installed (for variant calling)
- Basic install of R (for strandbias test by VarDict)
- Perl (For var2vcf module of Vardict)

Data requirement for variant calling
- Reference genome FASTA file. This should be indexed by the same alignment software used for generating the BAM file
- Sorted, deduplicated, indexed, and realigned BAM file 

### Download Pre-built Binaries

Download the latest release for your platform from the [Releases](https://github.com/roysomak4/FGFR1-ITD-seeker/releases) page:

- **macOS (Intel)**: `fgfr1-itd-seeker-X.X.X-darwin-amd64`
- **macOS (Apple Silicon)**: `fgfr1-itd-seeker-X.X.X-darwin-arm64`
- **Linux**: `fgfr1-itd-seeker-X.X.X-linux-amd64`

Make the binary executable:
```bash
chmod +x fgfr1-itd-seeker-*
```

### Build from Source

```bash
# Clone the repository
git clone https://github.com/yourusername/FGFR1-ITD-seeker.git
cd FGFR1-ITD-seeker

# Build for current platform
make build

# Or build for all platforms
make build-release-all
```

## Usage

### Basic Command

```bash
./fgfr1-itd-seeker \
  --ref /path/to/reference.fa \
  --inputBam /path/to/sample.bam \
  --outVcf /path/to/output.vcf \
  --sampleName SAMPLE_001 \
  --genomeVer hg38
```

### Command-line Options

| Option | Description | Default |
|--------|-------------|---------|
| `--ref` | Path to reference genome (must be indexed) | Required |
| `--inputBam` | Path to sorted, deduped, indexed BAM file | Required |
| `--outVcf` | Path to output VCF file | Required |
| `--sampleName` | Sample name for VCF annotations | Required |
| `--genomeVer` | Human genome version (hg19, hg38) | `hg38` |
| `--minVaf` | Minimum variant allele frequency (0-1) | `0.01` |
| `--threads` | Number of threads to use | `4` |
| `--version` | Show version information | - |

### Example

```bash
./fgfr1-itd-seeker \
  --ref /data/genomes/hg38.fa \
  --inputBam /data/samples/patient01.bam \
  --outVcf /data/results/patient01_FGFR1_ITD.vcf \
  --sampleName Patient_01 \
  --genomeVer hg38 \
  --minVaf 0.05 \
  --threads 8
```

## Output

The tool generates a filtered VCF file containing only FGFR1 ITD variants that meet the following criteria:

- ALT allele length > REF allele length
- ALT allele length â‰¥ 4000 bp
- Started of the called ITD breakpoint starts within exon 18

If no variants pass the filters, the output valid VCF will contain only the header with no variant records. This filter is put in place to minimize the noise generated by VarDict when calling short variants in the region of FGFR1 gene

## BED Files

The tool requires the following BED files for (already included in the repository for hg19 and hg38 genome versions):
1. FGFR1 gene coordinates: `bedfiles/<genome>/FGFR1_gene.bed`
2. Exon breakpoint coordinates: `bedfiles/<genome>/FGFR1_ITD_breakpoint_exons.bed`

Unless some customization is necessary, it is not recommended to change or update these files. If one does want custom BED file, they must be present in the `bedfiles/` directory for the specified genome version.

## License

This project is licensed under the GNU General Public License v3.0 - see the [LICENSE](LICENSE) file for details.

## Citation

The manuscript is in preparation...

## Contact

We would love your feedack to improve this tool. Please post an issue with enhancements, bugs or any other requests.
